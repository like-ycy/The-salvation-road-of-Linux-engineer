# 常用指令

指令 (Directives) 是带有“v-”前缀的特殊属性，由vue提供的。每一个指令在vue中都有固定的作用。

在vue中，提供了很多指令，常用的有：v-if、v-model、v-for等等。

指令会在vm对象的data选项数据发生变化时，会同时改变元素中的其控制的内容或属性。

因为vue的历史版本原因，所以有一部分指令都有两种写法：

```
vue1.x写法             vue2.x/vue3.x的写法
v-html         ---->   v-html
{{ 普通文本 }}          {{普通文本}}  v-text="普通文本"
v-bind:属性名   ---->   :属性
v-on:事件名     ---->   @事件名
```



## 1.1 属性操作

格式：

```
<标签名 :标签属性="data属性"></标签名>
```



```html
<p :title="str1">{{ str1 }}</p> <!-- 也可以使用v-html显示双标签的内容，{{  }} 是简写 -->
<a :href="url2">淘宝</a>
<a v-bind:href="url1">百度</a>  <!-- v-bind是vue1.x版本的写法 -->
```

显示wifi密码效果：

```vue
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
</head>
<body>

<div id="app">
    <input :type="type" v-model="password"><button @click="change">{{text}}</button>
</div>

<script>
    const vm = Vue.createApp({
        data(){ // 数据选项
            return {
                type: "password",
                password: "",
                text: "显示密码",
            }
        },
        methods:{ // 方法选项
            change(){
                if(this.type === "password"){
                    this.type = "text";
                    this.text = "隐藏密码";
                }else{
                    this.type = "password";
                    this.text = "显示密码";
                }
            }
        }
    }).mount("#app");
</script>
</body>
</html>
```



## 1.2 事件绑定

有两种事件操作的写法，@事件名 和 v-on:事件名

```html
<button v-on:click="num+=5">按钮</button>
<button @click="num+=5">按钮</button>
```

```
1. 使用@事件名来进行事件的绑定
   语法：
      <h1 @click="num++">{{num}}</h1>

2. 绑定的事件的事件名，全部都是js的事件名：
   @submit   --->  onsubmit
   @focus    --->  onfocus
   @blur     --->  onblur
   @click    --->  onclick
   ....
```



#### 例如:完成商城购物车中的商品增加减少数量

步骤：

1. 给vue对象添加操作数据的方法
2. 在标签中使用指令调用操作数据的方法

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
</head>
<body>

<div id="app">
    <button @click="sub">-</button>
    <input type="text" v-model="num" size="2">
    <button @click="add">+</button>
</div>

<script>
    const vm = Vue.createApp({
        data(){
            return {
                num: 1,   // 当前用户选择的商品数量
                max: 10,  // 商品库存
            }
        },
        methods:{
            sub(){
                // 减少数量
                if(this.num<=1) return ;  // 阻止代码继续往下执行,return 表示函数结束了。
                this.num-=1;
            },
            add(){
                // 增加数量
                if(this.num>=this.max) return ;
                this.num+=1;
            }
        }

    }).mount("#app")
</script>
</body>
</html>
```



## 1.3 操作样式

操作样式，本质就是属性操作，使用冒号：

### 1.3.1 控制标签class类名

```
格式：
   <h1 :class="值">元素</h1>  # 值可以是变量名、对象、对象的变量名、数组、数组变量名
```



```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
    <style>
    .p1{
        background: maroon;
        color: aqua;
    }
    .p2{
        background: yellow;
        color: blue;
    }
    .p3{
        border: 3px solid red;
    }
    </style>
</head>
<body>

<div id="app">
    <p :class="p1_cls" @click="p1_cls='p2'">p1</p>
    <p :class="{p1: use_p1, p2: user_p2}" @click="user_p2=!user_p2">p2</p><!-- 最常用 -->
    <p :class="cls" @click="cls.p2=!cls.p2">p3</p><!-- 最常用 -->
    <p :class="[cls,cls1]">p4</p>
    <p :class="condition?'p1':'p2'">p5</p>
    <p class="p3" :class="condition?'p1':'p2'" @click="condition=!condition">p6</p> <!-- 最常用 -->
</div>

<script>
    const vm = Vue.createApp({
        data(){
            return {
                p1_cls: "p1",
                use_p1: true,
                user_p2: false,
                cls: {
                    p1: true,
                    p2: false
                },
                cls1:{
                    p3: true,
                },
                condition: true,
            }
        }
    }).mount("#app")
</script>
</body>
</html>
```

代码执行效果：

![image-20211026121211737](2%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4.assets/image-20211026121211737.png)

总结：

```html
1. 给元素绑定class类名，最常用的就是第2,3种以及最后一种。
    vue对象的data数据：
        data:{
          myObj:{
            complete:true,
            uncomplete:false,
          }
        }

		html元素：    
    		<div class="box" :class="myObj">2222</div>
    最终浏览器效果：
		    <div class="box complete">2222</div>
```





### 1.3.2 控制标签style样式

工作中基本很少出现style控制样式，一个规范不允许，另一个就是代码不好维护。

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
</head>
<body>

<div id="app">
    <div :style="{color: activeColor, fontSize: fontSize + 'px' }" @click="fontSize+=1">div1</div>
    <div :style="styleObject">div2</div>
    <div :style="[style1,style2]">div3</div>
</div>

<script>
    const vm = Vue.createApp({
        data(){
            return {
                activeColor: "red",
                fontSize: 30,
                styleObject:{
                    fontSize: "30px",
                    backgroundColor: 'yellow'
                },
                style1:{
                    color:"red"
                },
                style2:{
                    background:"orange",
                    fontSize: "21px"
                }
            }
        }
    }).mount("#app")
</script>
</body>
</html>
```



### 1.3.3 实例-vue版本选项卡

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
    <style>
    p{
        padding: 0;
        margin: 0;
    }
    .title-list span{
        display: inline-block; /* 设置元素的显示模式：行级块状元素 */
        height: 60px;
        line-height: 60px;
        width: 120px;
        background-color: #bbb;
        text-align: center;
        cursor: pointer;
    }
    .title-list .activate{
        background-color: yellow;
    }
    .content-list .content{
        background-color: yellow;
        display: none;
        width: 370px;
        height: 280px;
    }
    .content-list .current{
        display: block;
    }
    </style>
</head>
<body>

<div id="optioncart">
    <div class="title-list">
        <span :class="{activate: key === 0}" @click="key=0">国内新闻</span>
        <span :class="{activate: key === 1}" @click="key=1">国际新闻</span>
        <span :class="{activate: key === 2}" @click="key=2">银河新闻</span>
    </div>
    <div class="content-list">
        <div class="content" :class="{current: key ===0}">
            <p>国内新闻列表</p>
            <p>国内新闻列表</p>
            <p>国内新闻列表</p>
            <p>国内新闻列表</p>
            <p>国内新闻列表</p>
        </div>
        <div class="content" :class="{current: key ===1}">
            <p>国际新闻列表</p>
            <p>国际新闻列表</p>
            <p>国际新闻列表</p>
            <p>国际新闻列表</p>
            <p>国际新闻列表</p>
        </div>
        <div class="content" :class="{current: key ===2}">
            <p>银河新闻列表</p>
            <p>银河新闻列表</p>
            <p>银河新闻列表</p>
            <p>银河新闻列表</p>
            <p>银河新闻列表</p>
        </div>
    </div>
</div>

<script>
    const vm = Vue.createApp({
        data(){
            return {
                key: 0,
            }
        }
    }).mount("#optioncart")
</script>
</body>
</html>
```

代码运行效果：

![1552038219804](2%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4.assets/1552038219804.png)

## 1.4 条件渲染指令

vue中提供了两个指令可以用于**判断是否要显示**元素，分别是v-if和v-show。

### 1.4.1 v-if

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
</head>
<body>
    <div id="app">
        <!-- vue对象最终会把条件的结果变成布尔值 -->
        <p v-if="username">欢迎回到xx网站，{{username}}</p>
    </div>
    <script>
        const vm =Vue.createApp({
            data(){
                return {
                    username: "",
                }
            },
        }).mount("#app")

    </script>
</body>
</html>
```

### 1.4.2 v-else

v-else指令来表示 v-if 的“else 块”，v-else 元素必须紧跟在带 v-if 或者 v-else-if 的元素的后面，否则它将不会被识别。

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
</head>
<body>
    <div id="app">
        <!-- v-else只能作为子语句，跟在上一个v-if后面，而且只能出现一次,否则后面v-else会覆盖前面的v-else -->
        <p v-if="username">欢迎回到xx网站，尊敬的{{username}}！</p>
        <p v-else>欢迎访问xx网站，尊敬的游客！</p>
        <p v-else>欢迎访问xx网站，尊敬的游客！2</p>
    </div>
    <script>
        const vm =Vue.createApp({
            data(){
                return {
                    username: "",
                }
            },
        }).mount("#app")

    </script>
</body>
</html>
```



### 1.4.3 v-else-if

可以出现多个v-else-if语句，但是v-else-if之前必须有一个v-if开头。后面可以跟着v-else，也可以没有。

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
    <style>
    .l0{
        color: #000;
    }
    .l1{
        color: #ffff99;
        background: black;
    }
    .l2{
        color: #ffff33;
        background: black;
    }
    .l3{
        color: #aaaa00;
        background: black;
    }
    </style>
</head>
<body>
    <div id="app">
        <p v-if="username">欢迎回到xx网站，尊敬的{{username}}！</p>
        <p v-else>欢迎访问xx网站，尊敬的游客！</p>
        <p v-if="level === 0" class="l0">您是vip会员！</p>
        <p v-else-if="level === 1" class="l1">您是svip会员！</p>
        <p v-else-if="level === 2" class="l2">您是mvip会员！</p>
        <p v-else-if="level === 3" class="l3">您是msvip会员！</p>
        <p v-else>您是签到会员！</p>
    </div>
    <script>
        const vm =Vue.createApp({
            data(){
                return {
                    username: "", // 会员账户名
                    level: 0,     // 会员登录
                }
            },
        }).mount("#app")

    </script>
</body>
</html>
```



### 1.4.4 v-show

用法和v-if大致一样，区别在于2点：

1. v-show后面不能v-else或者v-else-if

2. v-show隐藏元素时，使用的是csss样式的display:none来隐藏的，

   而v-if是直接从HTML文档中移除元素[ DOM操作中的remove ] 

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
</head>
<body>
    <div id="app">
        <p v-show="username">欢迎回到xx网站，尊敬的{{username}}！</p>
        <p v-show="!username">欢迎访问xx网站，尊敬的游客！</p>
    </div>
    <script>
        const vm =Vue.createApp({
            data(){
                return {
                    username: "", // 会员账户名
                }
            },
        }).mount("#app")

    </script>
</body>
</html>
```

当页面中有使用了其他的前端插件，这些插件也操作了和vue控制的内容范围重叠，则需要使用v-show。



## 1.5 列表渲染指令

在vue中，可以通过v-for指令可以将一组数据渲染到页面中，数据可以是数组或者对象。

```html
数据是数组：        
        <ul>
            <!--book是列表的每一个元素-->
            <li v-for="book in book_list">{{book.title}}</li>
        </ul>

        <ul>
            <!--book是列表的每一个元素，index是每个元素的下标-->
            <li v-for="(book, index) in book_list">第{{ index+1}}本图书：{{book.title}}</li>
        </ul>


        <script>
            var vm1 = new Vue({
                el:"#app",
                data:{
                    book_list:[
                        {"id":1,"title":"图书名称1","price":200},
                        {"id":2,"title":"图书名称2","price":200},
                        {"id":3,"title":"图书名称3","price":200},
                        {"id":4,"title":"图书名称4","price":200},
                    ]
                }
            })
        </script>

数据是对象：
        <ul>
            <!--i是每一个value值-->
            <li v-for="value in book">{{value}}</li>
        </ul>
        <ul>
            <!--i是每一个value值,j是每一个键名-->
            <li v-for="attr, value in book">{{attr}}:{{value}}</li>
        </ul>
        <script>
            var vm1 = new Vue({
                el:"#app",
                data(){
                    return {
                        book: {
                            // "attr":"value"
                            "id":11,
                            "title":"图书名称1",
                            "price":200
                        },
                	}
                }
            })
        </script>

```

课堂代码；

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue-3.1.5.js"></script>
    <style>
    .table{
        border-collapse: collapse;
        width: 800px;
    }
    .table th,
    .table td{
        height: 42px;
        border: 1px red solid;
    }
    .bg{
        background-color: aquamarine;
    }
    </style>
</head>
<body>
    <div id="app">
        <table class="table">
            <tr>
                <th>编号</th>
                <th>标题</th>
                <th>价格</th>
                <th>属性</th>
            </tr>
            <!-- 循环数组 ,item表示数组中的每一个成员，key表示成员对应的下标，item和key都是变量，也可以叫他名字 -->
            <tr v-for="item,key in book_list">
                <th>{{item.id}}{{key}}</th>
                <th>{{item.title}}</th>
                <th v-if="item.price<2000">{{item.price}}</th>
                <th v-else class="bg">{{item.price}}</th>
                <th>
                    <!-- 循环对象，attr表示循环过程对象的属性值，key表示循环过程中对象的属性名。attr和key都是自定义变量，也可以别的名字 -->
                    <div v-for="attr,key in item.attrs">
                        {{key}}: {{attr}}
                    </div>
                </th>
            </tr>
        </table>
    </div>
    <script>
        const vm = Vue.createApp({
            data(){
                return {
                    book_list:[
                        {"id":1,"title":"华为手机 Meta 4","price":4000,'attrs':{"网络":"5G", "颜色":"海蓝色", "分辨率":"5000万", "机身内存":"128G", "运行内存":"8G",}},
                        {"id":2,"title":"华为手机 Meta 3","price":2200,'attrs':{"网络":"4G", "颜色":"海蓝色", "分辨率":"3200万", "机身内存":"64G", "运行内存":"4G",}},
                        {"id":3,"title":"小米 Note 7","price":3200,'attrs':{"网络":"5G", "颜色":"粉红色", "分辨率":"5200万", "机身内存":"128G", "运行内存":"4G",}},
                        {"id":4,"title":"雕牌洗衣粉","price":18,'attrs':{"产地":"北京", "成分":"化学成分", "重量":"1kg", "香味":"柠檬味", "包装":"袋装",}},
                    ]
                }
            },
        }).mount("#app")
    </script>
</body>
</html>
```



练习：

```html
goods:[
	{"name":"python入门","price":150},
	{"name":"python进阶","price":100},
	{"name":"python高级","price":75},
	{"name":"python研究","price":60},
	{"name":"python放弃","price":110},
]

# 把上面的数据采用table表格输出到页面，价格大于60的数据需要添加背景色橙色[orange]
```

代码：

```vue
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script src="js/vue-3.1.5.js"></script>
    <style>
    .bg{
        background-color: orange;
    }
    </style>
</head>
<body>
    <div id="app">
        <table border="1" width="600">
            <tr>
                <th>name</th>
                <th>price</th>
                <th>number</th>
                <th>doing</th>
            </tr>
            <tr v-for="item,key in goods" :class="{bg:item.price>60}">
                <th>{{item.name}}</th>
                <th>{{item.price}}</th>
                <th>
                    <button @click="sub(item)">-</button>
                    <input type="text" size="1" v-model="item.num">
                    <button @click="add(item)">+</button>
                </th>
                <th><span @click="del(key)">删除</span></th>
            </tr>
        </table>
    </div>
    <script>
        /**
         * goods:[
            {"name":"python入门","price":150},
            {"name":"python进阶","price":100},
            {"name":"python高级","price":75},
            {"name":"python研究","price":60},
            {"name":"python放弃","price":110},
          ]

          把上面的数据采用table表格输出到页面，价格大于60的数据需要添加背景色橙色[orange]
         */
        Vue.createApp({
            data(){
                return {
                    goods:[
                        {"name":"python入门","price":150, num: 100,},
                        {"name":"python进阶","price":100, num: 100,},
                        {"name":"python高级","price":75, num: 100,},
                        {"name":"python研究","price":60, num: 100,},
                        {"name":"python放弃","price":110, num: 100,},
                      ]
                }
            },
            methods:{
                sub(item){
                    // 商品数量减少
                    item.num--
                },
                add(item){
                    // 商品数量增加
                    item.num++
                },
                del(key){
                    this.goods.splice(key,1)
                }
            }
        }).mount("#app")
    </script>
</body>
</html>
```



## 2. Vue对象提供的其他的选项API

## 2.1 过滤器

Vue3.0已经被淘汰了过滤器这个选项，所以我们这里使用2.6.11版本来完成代码的编写。

过滤器，就是vue允许开发者自定义的文本格式化函数，可以使用在两个地方：输出内容和操作数据中。

定义过滤器的方式有两种：全局过滤器和局部过滤器。

### 2.1.1 使用Vue.filter()进行全局定义

js/filters.js，代码：

```javascript
// 全局范围定义的过滤器
Vue.filter("money1", function(v){
    //就是来格式化(处理)v这个数据的
    if(v==0){
        return v
    }
    return v.toFixed(2)+"元"
})
```



### 2.1.2 在vue对象中通过filters选项来局部定义

```vue
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.2.6.11.js"></script>
    <script src="js/filters.js"></script>
</head>
<body>
    <div id="app">
        <p @click="add">{{num | money1}}</p>
        <p @click="add">{{num | money}}</p>
    </div>
    <script>
        const vm =new Vue({ // 在vue3.0以后，替换成了Vue.createApp()
            el: "#app",  // 在vue3.0以后，没有el选项了，换成了mount()
            data(){
                return {
                    num: 100.453
                }
            },
            methods:{
                add(){
                    this.num+=1;
                }
            },
            // 在vm对象内部通过filters选项来自定义过滤器
            filters:{
                money(data){
                    return data.toFixed(2)+"元"
                }
            }
        })

    </script>
</body>
</html>
```



## 2.2 计算属性和侦听属性

### 2.2.1 计算属性

所谓的计算属性，是vue提供给我们开发者用于编写代码时计算出新的数据保存的变量来的。主要通过computed进行声明的。

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
    <style>
    table{
        border-collapse: collapse;
        border: 1px solid red;
    }
    td, th{
        border: 1px solid red;
        padding: 10px 18px;
    }
    </style>
</head>
<body>
    <div id="app">
        <table>
            <tr>
                <th>ID</th>
                <th>title</th>
                <th>price</th>
                <th>number</th>
                <th>total</th>
            </tr>
            <tr v-for="goods in goods_list">
                <td>{{goods.id}}</td>
                <td>{{goods.title}}</td>
                <td>{{goods.price}}</td>
                <td>
                    <button @click="sub(goods)">-</button>
                    <input type="text" size="1" v-model="goods.num">
                    <button @click="add(goods)">+</button>
                </td>
                <td>{{(goods.num * goods.price).toFixed(2)}}</td>
            </tr>
            <tr>
                <td colspan="3"></td>
                <td>总计：</td>
                <td>{{total_price}}</td>
            </tr>
            <tr>
                <td colspan="3"></td>
                <td>实付价格：</td>
                <td>{{discount_price}}</td>
            </tr>
        </table>
    </div>
    <script>
        const vm = Vue.createApp({
            data(){
                return {
                    goods_list:[
                        {"id":10,"title":"商品1","price":688.50, "num": 0,},
                        {"id":21,"title":"商品2","price":30.80, "num": 0,},
                        {"id":35,"title":"商品3","price":150.00, "num": 0,},
                        {"id":50,"title":"商品4","price":100.30, "num": 0,},
                    ]
                }
            },
            computed:{
                // 计算属性，相当于在data选项中声明了一个变量，
                // computed的成员都是函数来的，使用的时候相当于data选项里面的变量，但是computed中的变量，可以随着其他的变化而变化
                total_price(){
                    let total = 0;
                    for(let goods of this.goods_list){
                        total += goods.price * goods.num;
                    }
                    return total.toFixed(2)
                },
                discount_price(){
                    // 超过2000，优惠500
                    let total = this.total_price;
                    if(this.total_price>2000){
                        total = this.total_price - 500;
                    }
                    return parseFloat(total).toFixed(2);
                }
            },
            methods:{
                add(goods){
                    goods.num+=1;
                },
                sub(goods){
                    if(goods.num<=0) return;
                    goods.num-=1;
                },
            }
        }).mount("#app")
    </script>
</body>
</html>
```



### 2.2.2 侦听属性

侦听属性，可以帮助我们侦听data某个数据的变化，从而做相应的自定义操作。

侦听属性是一个对象，它的键是要监听的对象或者变量，值一般是函数，当侦听的data数据发生变化时，会自定执行的对应函数，这个函数在被调用时，vue会传入两个形参，第一个是变化前的数据值，第二个是变化后的数据值。

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
    <style>
    input{
        outline: none;
        border: 1px solid #333;
    }
    </style>
</head>
<body>
    <div id="app">
        账户：<input ref="username" type="text" v-model="username"><br><br>
        口令：<input ref="password" type="text" v-model="password"><br><br>
    </div>
    <script>
        const vm = Vue.createApp({
            data(){
                return {
                    username: "",
                    password: "",
                }
            },
            watch:{
                // 侦听属性，也叫监听属性，主要用于监听data或者computed中的变量如果发生值的改动，则自动执行watch中的同名成员方法
                username(){
                    console.log(`username=${this.username}`)
                    let length = this.username.length;
                    if(length>=6 && length<=16){
                       this.$refs.username.style.border="1px solid blue";
                    }else{
                       this.$refs.username.style.border="1px solid #333";
                    }
                },
                password(new_value, old_value){ // 参数为：修改前的变量值以及修改后的变量值
                    if(/^\d+$/.test(this.password)){
                        this.$refs.password.style.border="1px solid red";
                    }else{
                        this.$refs.password.style.border="1px solid #333";
                    }
                }
            }
        }).mount("#app")
    </script>
</body>
</html>
```



## 2.3 vue对象的生命周期

每个Vue对象在创建时都要经过一系列的初始化过程。在这个过程中Vue.js会**自动运行**一些叫做生命周期的的**钩子函数**，我们可以使用这些函数，在对象创建的不同时间阶段加上我们需要的自动执行代码，就实现特定的功能。

![assets/vm对象的生命周期钩子方法.png](2%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4.assets/vm%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90%E6%96%B9%E6%B3%95.png)

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue-3.1.5.js"></script>
</head>
<body>
    <div id="app">
        <input type="text" v-model="num"><p>{{num}}</p>
    </div>
    <script>
        const vm = Vue.createApp({
            data(){
                return {
                    num: 10,
                }
            },
            beforeCreate(){
                // 初始化选项api之前
                console.log(">>>>>>>>>> beforeCreate执行了。")
                console.log(this.$data)
                console.log(this.num)
            },
            created(){
                // 初始化选项api之后
                console.log(">>>>>>>>>> created执行了。开发中一般在这里进行数据的初始化，编写ajax或其他的网络请求。")
                console.log(this.$data)
                console.log(this.num)
                console.log(this.$el) // 此时无法操作HTML模板的。还没有加载到vm对象中。
            },
            beforeMount(){
                // 读取视图模板，进行数据替换之前
                console.log(">>>>>>>>>> beforeMount执行了。")
            },
            mounted(){
                console.log(">>>>>>>>>> mounted执行了。开发中一般在这里进行页面的初始化，编写HTML页面/样式/其他的第三方插件的代码等等")
                // 把data中的变量替换到视图模板中了
                console.log(this.$el.parentElement.innerHTML)
            },
            beforeUpdate(){
                // data数据被改动以后，同步到HTML视图模板之前
                console.log(">>>>>>>>>> beforeUpdate执行了。")
                console.log(this.num, this.$el.parentElement.innerHTML)
            },
            updated(){
                // data数据被改动，并同步到HTML视图模板之后
                console.log(">>>>>>>>>> updated执行了。")
                console.log(this.num, this.$el.parentElement.innerHTML)
            }
        }).mount("#app")
    </script>
</body>
</html>
```



总结：

```
在vue使用的过程中，如果要初始化操作，把初始化操作的代码放在 mounted 中执行。
mounted阶段就是在vm对象已经把data数据实现到页面以后。一般页面初始化使用。例如，用户访问页面加载成功以后，就要执行的ajax请求。

另一个就是created，这个阶段就是在 vue对象创建以后，把ajax请求后端数据的代码放进 created
```



## 2.4 指令修饰符

v-model的指令修饰符。

```vue
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
</head>
<body>
    <div id="app">
<!--        v-model.trim 用于去除字符串两边的空白字符，常用于密码-->
        <input type="password" v-model.trim="password"><br>
<!--        v-model.lazy 用于减少触发watch侦听选项的频率，从原来的input输入事件的侦听切换成了change值改变事件的监听-->
        <input type="text" v-model.lazy="mobile"><br>
        <!-- v-model.number 表示把变量作为数值来进行转换提取，能转的都会转换 -->
        <input type="text" size="1" v-model.number="num"> + 500 = <span>{{num+500}}</span>
    </div>
    <script>
        const vm = Vue.createApp({
            data(){
                return {
                    password: "",
                    mobile: "",
                    num: 0,
                }
            },
            watch:{
                password(){
                    console.log(this.password);
                },
                mobile(){
                    console.log("发送http请求验证手机号是否在服务端注册了");
                    console.log(this.mobile);
                }
            }
        }).mount("#app");
    </script>
</body>
</html>
```



事件指令的修饰符使用.stop和.prevent

.prevent 用于阻止页面跳转

.stop 用于阻止事件继续冒泡

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        .box1{
            width: 200px;
            height: 200px;
            background: #ccc;
        }
        .box2{
            width: 100px;
            height: 100px;
            background: pink;
        }
    </style>
    <script src="js/vue.min.js"></script>
    <script>
    window.onload = function(){
        var vm = new Vue({
            el:"#app",
            data(){
                return {
                    
                }
            }
        })        
    }
    </script>
</head>
<body>
    <div id="app">
        <div class="box1" @click="alert('box1')">
            <div class="box2" @click.stop.prevent="alert('box2')"></div>   <!-- @click.stop来阻止事件冒泡 -->
        </div>

        <form action="#">
            <input type="text">
            <input type="submit">
            <input type="submit" value="提交02" @click.prevent=""> <!-- @click.prevent来阻止表单提交 -->
        </form>
    </div>

</body>
</html>
```

课堂代码：

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/vue.3.2.20.js"></script>
    <style>
    body{
        padding: 0;
        margin: 0;
    }
    #app2{
        position: fixed;
        top: 0;
        left: 0;
        background-color: rgba(0,0,0,0.6);
        color: #fff;
        width: 68vw;
        padding-top: 30vh;
        padding-bottom: 30vh;
        padding-left: 32vw;
    }
    a{
        color: #fff;
        text-decoration: none;
    }
    </style>
</head>
<body>
    <div id="app">
        <button @click="show_login_box=!show_login_box">登录</button>
        <div id="app2" v-if="show_login_box" @click="show_login_box=false">
            <div @click.stop="">
                账户：<input ref="username" type="text" v-model="username"><br><br>
                口令：<input ref="password" type="text" v-model="password"><br><br>
            </div>
            <a href="http://www.baidu.com" @click.prevent.stop="check_params">登录</a>&nbsp;&nbsp;
            <a @click="show_login_box=false">取消</a>
        </div>
    </div>
    <script>
        const vm = Vue.createApp({
            data(){
                return {
                    show_login_box: false,
                    password: "",
                    username: "",
                }
            },
            methods:{
                check_params(){
                    if(this.username != "xiaoming"){
                        console.log("验证数据失败！!");
                        return ; // 阻止代码继续往下执行
                    }

                    console.log("跳转页面的代码");
                }
            }
        }).mount("#app");
    </script>
</body>
</html>
```



## 2.5 综合案例-todolist

我的计划列表

html代码:

```html
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>todolist</title>
	<style type="text/css">
		.list_con{
			width:600px;
			margin:50px auto 0;
		}
		.inputtxt{
			width:550px;
			height:30px;
			border:1px solid #ccc;
			padding:0px;
			text-indent:10px;
		}
		.inputbtn{
			width:40px;
			height:32px;
			padding:0px;
			border:1px solid #ccc;
		}
		.list{
			margin:0;
			padding:0;
			list-style:none;
			margin-top:20px;
		}
		.list li{
			height:40px;
			line-height:40px;
			border-bottom:1px solid #ccc;
		}

		.list li span{
			float:left;
		}

		.list li a{
			float:right;
			text-decoration:none;
			margin:0 10px;
		}
	</style>
</head>
<body>
	<div class="list_con">
		<h2>To do list</h2>
		<input type="text" name="" id="txt1" class="inputtxt">
		<input type="button" name="" value="增加" id="btn1" class="inputbtn">

		<ul id="list" class="list">
			<!-- javascript:; # 阻止a标签跳转 -->
			<li>
				<span>学习html</span>
				<a href="javascript:;" class="up"> ↑ </a>
				<a href="javascript:;" class="down"> ↓ </a>
				<a href="javascript:;" class="del">删除</a>
			</li>
			<li><span>学习css</span><a href="javascript:;" class="up"> ↑ </a><a href="javascript:;" class="down"> ↓ </a><a href="javascript:;" class="del">删除</a></li>
			<li><span>学习javascript</span><a href="javascript:;" class="up"> ↑ </a><a href="javascript:;" class="down"> ↓ </a><a href="javascript:;" class="del">删除</a></li>
		</ul>
	</div>
</body>
</html>
```



特效实现效果：

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>todolist</title>
    <style>
      .list_con {
        width: 600px;
        margin: 50px auto 0;
      }
      .inputtxt {
        width: 550px;
        height: 30px;
        border: 1px solid #ccc;
        padding: 0px;
        text-indent: 10px;
      }
      .inputbtn {
        width: 40px;
        height: 32px;
        padding: 0px;
        border: 1px solid #ccc;
      }
      .list {
        margin: 0;
        padding: 0;
        list-style: none;
        margin-top: 20px;
      }
      .list li {
        height: 40px;
        line-height: 40px;
        border-bottom: 1px solid #ccc;
      }

      .list li span {
        float: left;
      }

      .list li a {
        float: right;
        text-decoration: none;
        margin: 0 10px;
      }
    </style>
    <script src="/js/vue.3.2.20.js"></script>
  </head>
  <body>
    <div class="list_con" id="app">
      <h2>To do list</h2>
      <input type="text" v-model="text" id="txt1" class="inputtxt" />
      <input
        type="button"
        @click="add_task"
        value="增加"
        id="btn1"
        class="inputbtn"
      />

      <ul id="list" class="list">
        <li v-for="task,key in task_list">
          <span>{{task}}</span>
          <a href="" @click.prevent="up_task(key)" class="up"> ↑ </a>
          <a href="" @click.prevent="down_task(key)" class="down"> ↓ </a>
          <a href="" @click.prevent="del_task(key)" class="del">删除</a>
        </li>
      </ul>
    </div>
    <script>
      const vm = Vue.createApp({
        data() {
          return {
            text: "",
            task_list: ["学习html", "学习js", "学习css"],
          };
        },
        created() {
          this.read_data();
        },
        methods: {
          add_task() {
            // 添加计划任务
            if (this.text.length < 1) {
              alert("计划任务不能为空！");
              return;
            }
            // 追加任务到列表中
            this.task_list.push(this.text);
            this.text = ""; // 清空用户在输入框的内容
            this.save_data();
          },
          del_task(key) {
            // 删除计划任务
            this.task_list.splice(key, 1);
            this.save_data();
          },
          down_task(key) {
            // 下移计划任务
            let del_task_list = this.task_list.splice(key, 1);
            this.task_list.splice(key + 1, 0, del_task_list[0]);
            this.save_data();
          },
          up_task(key) {
            // 上移计划任务
            // 任务在最上方，则不移动
            if (key === 0) {
              return;
            }
            let del_task_list = this.task_list.splice(key, 1);
            this.task_list.splice(key - 1, 0, del_task_list[0]);
            this.save_data();
          },
          save_data() {
            // 存储数据
            console.log("存储数据");
            localStorage.setItem("task_list", JSON.stringify(this.task_list));
          },
          read_data() {
            // 读取数据
            this.task_list = JSON.parse(localStorage.getItem("task_list"));
          },
        },
      }).mount("#app");
    </script>
  </body>
</html>
```

## 2.6 webStorage本地存储

是HTML5提供的用于在本地实现离线存储的一种技术方案。HTML5中提供了2个全局对象用于保存数据到本地浏览器或者移动端的webapp中，分别是：localStorage和sessionStorage。这2个对象，使用方式一致，区别仅仅是存储数据的有效期不同。

localStorage   永久存储，不主动删除，会一直保存在本地。

sessionStorage 会话存储，当浏览器重启以后，数据则会丢失。

这个对象保存数据时，都是域名进行区分保存的，不同的域名保存在本地存储的相互之间是互不干扰，互不影响的。

localStorage的用法：

```javascript
// 保存一个数据
localStorage.setItem("变量名", "变量值");
// localStorage.变量名="变量值"

// 获取一个数据
localStorage.getItem("变量名");     // 返回值：变量值
// 变量值 = localStorage.变量名

// 删除一个数据
localStorage.removeItem("变量名");

// 清空当前域名下所有的数据
localStorage.clear();
```

sessionStorage 的用法：

```javascript
// 保存一个数据
sessionStorage.setItem("变量名", "变量值");
// sessionStorage.变量名="变量值"

// 获取一个数据
sessionStorage.getItem("变量名");     // 返回值：变量值
// 变量值 = sessionStorage.变量名

// 删除一个数据
sessionStorage.removeItem("变量名");

// 清空当前域名下所有的数据
sessionStorage.clear();
```







