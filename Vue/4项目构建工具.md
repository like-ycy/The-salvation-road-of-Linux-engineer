# 项目构建工具

在前端开发中, 前端开发人员**方便快速构建和管理项目**,一般都会使用一些项目构建工具来辅助开发.而我们接下来要学习的单文件组件则必须依赖于项目构建工具才能完成这块的学习,目前来说,vue开发中一般常用的前端开发工具无非: vue-cli和vite这2款最多人使用. 

## Vue自动化工具（Vue-cli）

vue2.0官方推荐使用vue-cli，vue3.0官方推荐使用vite2.0。

一般情况下vue的单文件组件使用中，我们运行都会在vue-CLI中进行开发，它可以帮我们把单文件组件编译成普通的js代码。所以我们需要在电脑先安装搭建vue-CLI工具。

官网：https://cli.vuejs.org/zh/

Vue-CLI 由nodejs编写的，所以我们需要 [Node.js](https://nodejs.org/) 8.9 或更高版本 (推荐 10.0+)。你可以使用 [nvm](https://github.com/creationix/nvm) 或 [nvm-windows](https://github.com/coreybutler/nvm-windows)在同一台电脑中管理多个 Node 版本。

mac OS系统下nvm工具的下载和安装：https://www.jianshu.com/p/622ad36ee020

windows安装记录：

打开: https://github.com/coreybutler/nvm-windows/releases

安装完成以后,先查看环境变量是否设置好了.

![1552357036022](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/1552357036022.png)

```
常用的nvm命令
nvm ls-remote                # 列出远程服务器上所有的可用版本,需要网络
nvm list                     # 列出目前在nvm里面安装的所有node版本
nvm install node版本号        # 安装指定版本的node.js
nvm uninstall node版本号      # 卸载指定版本的node.js
nvm use node版本号            # 切换当前使用的node.js版本	
nvm alias defualt node版本号  # 切换当前系统默认使用的node.js版本
```

如果使用nvm工具，则直接可以不用自己手动下载nodejs，如果使用nvm下载安装nodejs的npm比较慢的时候，可以修改nvm的配置文件(在安装根目录下)。

在window系统下如果安装node的时候比较慢，则可以修改一下配置文件：

```
# 配置文件名：settings.txt
root: C:\tool\nvm    [这里的目录地址是安装nvm时自己设置的地址,要根据实际修改]
path: C:\tool\nodejs
arch: 64
proxy: none
node_mirror: http://npm.taobao.org/mirrors/node/ 
npm_mirror: https://npm.taobao.org/mirrors/npm/
```



## node.js

Node.js发布于2009年5月，由谷歌工程师Ryan Dahl(瑞安·达尔)开发的JavaScript运行环境，一个让 JavaScript代码运行在服务端的开发平台，它让javascript变成了服务端语言，所以nodejs开发者编写的代码本质上就是javascript代码。

后端语言和前端语言的区别：

- 运行环境：后端语言一般运行在服务器端，前端语言运行在客户端的浏览器上。
- 功能：后端语言可以操作文件，可以读写数据库，前端语言不能主动操作本地文件，不能读写数据库。

node.js的版本有两大分支：

奇数版本: 每年10月份发布，版本号为奇数，例如：17.0.0，叫当前版本（Current Version），维护期是3个月。

偶数版本: 次年04月份发布，版本号为偶数，例如：16.13.0， 叫长线支持版本（Long-Time Support Version），维护期是3年。

我们一般安装LTS(长线支持版本 Long-Time Support)：

下载地址：https://nodejs.org/en/download/【上面已经安装了nvm，那么这里不用手动安装了】

文档：https://nodejs.org/zh-cn/about/releases/

Node.js如果安装成功，可以查看Node.js的版本,在终端输入如下命令：

```
node -v
```



## npm包管理器

在安装node.js完成后，在node.js中会同时帮我们安装一个包管理器npm。我们可以借助npm命令来安装node.js的包。这个工具相当于python的pip包管理器。

```
npm install -g 包名             # 安装模块   -g表示全局安装，如果没有-g，则表示在当前项目安装
npm list                        # 查看当前目录下已安装的node包
npm view 包名 engines           # 查看包所依赖的Node的版本 
npm outdated                    # 检查包是否已经过时，命令会列出所有已过时的包
npm update 包名                  # 更新node包
npm uninstall 包名               # 卸载node包
npm 命令 -h                      # 查看指定命令的帮助文档
```

注意：npm虽然是nodejs官方提供的包管理工具，但事实上并不好用，所以有第三方开发者提供了更好用的yarn包管理器。

ubuntu20.04下安装yarn

```bash
# 注意：这里我们已经把我的node.js的版本换成了v16.6.0版本了。
# 大家如果也想使用这个使用版本，终端下执行以下命令
nvm install v16.13.0
nvm alias default v16.13.0
nvm use v16.13.0

# 安装yarn
curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
sudo apt update && sudo apt install -y yarn

# sudo apt remove yarn  # 卸载yarn
# sudo apt autoremove   # 卸载yarn相关其他依赖
```

windows下安装yarn

```bash
npm install -g yarn
```

我们可以通过npm来安装yarn包管理器。

```bash
yarn --version           # 查看版本   简写： yarn -v

# 基本使用命令
yarn global add 包名   全局安装包或模块，求掉global，表示本次项目安装
yarn remove 包名       卸载/移除包或模块
yarn                  根据在当前目录下的package.json的配置自动下载安装包列表，也可用yarn install
yarn dev              根据在当前目录下的package.json文件的配置启动一个http服务器运行前端项目
yarn init             根据在当前目录下自动生成一个package.json配置文件，用于自动构建前端项目
yarn publish          把当前目录下文件根据package.json配置，作为一个开源包发布到官方维护的包管理器列表中。
```

yarn默认的包管理服务器在国外，所以第一次使用yarn安装模块时会出现提示是否切换到淘宝镜像站，我们填写y即可。

![image-20210628103045183](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628103045183.png)



## 安装Vue-cli

```bash
npm install -g @vue/cli
# yarn global add @vue/cli  # 注意，安装不成功就换成npm
```

如果安装速度过慢，一直超时，可以考虑切换npm镜像源：http://npm.taobao.org/



## 使用Vue-CLI初始化创建vue项目

### 生成vue项目

使用vue-cli自动化工具可以快速搭建单页应用项目目录。

该工具为现代化的前端开发工作流提供了开箱即用的构建配置。只需几分钟即可创建并启动一个带热重载、保存时静态检查以及可用于生产环境的构建配置的项目。安装过程：

```bash
# vue create 项目目录名   # 会自动创建一个目录用于保存项目的。
cd ~/Desktop
vue create myproject
```

#### 默认安装

第一个选择安装配置，此处我们选择中间的（通过键盘上下键按钮移动），回车键：

![image-20210628103709834](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628103709834.png)

第二个，选择包管理器。默认选择了Yarn，所以我们直接回车即可。

![image-20210628103854285](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628103854285.png)

安装过程因为需要联网，所以如果出现网络安装失败，则重新安装多次。（4-5遍）

![image-20210628104322428](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628104322428.png)

安装成功以后，效果如下：

![image-20210628104417409](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628104417409.png)

跟着官方提示，输入命令。

![image-20210628104442707](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628104442707.png)

![image-20210628104533090](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628104533090.png)

打开蓝色链接地址，访问项目，`http://localhost:8080`：

![image-20210628104717625](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628104717625.png)

#### 自定义安装

```bash
cd ~/Desktop
vue create myproject2
```

第一，选择安装配置，最后一项就是选择自定义安装。回车。

![image-20210628103446496](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628103446496.png)

第二，选择项目依赖文件。空格表示选择/取消选择。选择完成以后，回车。

![image-20210628110207759](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628110207759.png)

```bash
Typescript入门：
链接：https://pan.baidu.com/s/1s78AnKSTdxMW12LUlbqCRg 
提取码：b5tv 
复制这段内容后打开百度网盘手机App，操作更方便哦
```



第三，根据上面的配置，选择vue版本为3.0版本。

![image-20210628110259151](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628110259151.png)

第四，选择路由Router的路由模式，问我们是否使用历史状态管理模型，就是路由没有`#`号。

![image-20210628110436922](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628110436922.png)

第五，选择配置EsLint的配置项。

![image-20210628110542002](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628110542002.png)

第六，ESLint格式化的时机。空格把2个都勾选上就行了。

![image-20210628110639426](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628110639426.png)

第七，EsLint和Babel的配置是否保存一块，选择第二个选项。

![image-20210628110731836](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628110731836.png)

第八，是否保存上面的一系列操作作为以后项目的安装配置。

![image-20210628110853230](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628110853230.png)

![image-20210628111018399](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210628111018399.png)

后续的安装过程，和上面的选择的默认安装流程一致了。



### 项目目录结构

```bash
项目根目录/
├── node_modules/     # 本地开发时项目运行的依赖库目录 
├── package.json      # 项目运营的配置文件
├── dist/             # 项目完成以后，如果要项目上线，会编译整个项目，编译后的代码保存这里。
├── public/           # 访问入口目录
│   └── index.html    # 项目唯一的html页面，整个项目所有的内容都是被index.html加载提供给用户访问的
└── src/              # 核心开发目录，所有的源代码都保存在这里
    ├── App.vue       # 项目的根组件，由App.vue进行加载所有的组件页面和子组件
    ├── assets/       # 资产目录，保存项目所需的静态资源[img/视频/音频等附件]
    ├── components/   # 子组件目录，保存一些零零碎碎的部分页面内容的组件
    ├── main.js       # 全局初始化入口脚本，index.html被运行时会自动加载这个js文件。
    ├── router/       # 路由文件保存
    │   └── index.js  # 默认情况下路由文件
    ├── store/        # 全局状态管理器，保存公共数据/公共变量的,Vuex
    │   └── index.js  # 默认情况的全局变量保存文件
    └── views/        # 页面组件目录，一个vue文件就一个页面内容。
        └── Home.vue
```



### vue项目执行流程图

![page_structrue](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/page_structrue.png)

整个项目是一个主文件index.html，index.html中会引入src文件夹中的main.js，main.js中会导入顶级单文件组件App.vue，App.vue中会通过组件嵌套或者路由来引用views页面组件，views组件会根据开发的页面需要加载components文件夹中的其他单文件子组件。



## Vite

vite是用于替代vue-cli而推出的新一代vue项目构建工具。在vue3.0版本中，推荐我们使用vite构建vue项目。

目前，vue3.0支持使用的vite版本是2.0版本。如果我们开发的vue是2.0版本，则可以安装对应的vite1.0版本来使用。

vite 中文官网：https://cn.vitejs.dev/

### 安装和搭建项目

安装步骤：

```bash
yarn global add vite
# 安装vite+vue3.0项目，Vite 需要 Node.js 版本 >= 12.0.0。
cd ~/Desktop
yarn create @vitejs/app
# npm init @vitejs/app
```

![image-20210701114416004](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210701114416004.png)

选择生成项目的前端web框架。

![image-20210701114455808](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210701114455808.png)

选择js的语法类型，原生js和typescript2种。

![image-20210701114653436](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210701114653436.png)

接下来，通过代码编辑器，打开项目。

![image-20210701114805377](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210701114805377.png)

根据终端提示，安装项目运行的依赖模块。

![image-20210701115037524](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210701115037524.png)

启动项目。

![image-20210701115058802](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210701115058802.png)

![image-20210701115122941](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210701115122941.png)

![image-20210701115235974](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210701115235974.png)

访问项目。默认端口就是3000，所以URL地址是：http://localhost:3000/

![image-20210701115325608](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210701115325608.png)



### 项目配置

项目根目录下新增了一个vite配置文件，我们可以通过vite配置一些插件，外部依赖模块的相关加载。

vite.config.js，代码：

```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [vue()]
})
```



### 项目打包

![image-20210805180602352](4%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7.assets/image-20210805180602352.png)

不管我们使用的是vue-cli还是vite进行项目构建和管理，将来要进行项目的部署迁移到外网服务器时，都是需要使用打包后的项目代码，打包后的代码会进行压缩，并且只需要运行在http服务器下面即可。我们一般在公司里面往往使用nginx来运行打包后的web前端项目。

因为我们暂时还没有学习到nginx，所以我们使用前端开发人员经常用于进行项目测试的live-server测试服务器来运行打包后的vue项目代码。

```python
# npm install -g live-server
yarn add live-server
```

运行项目。

```
cd ~/Desktop/www/dist   # 例如：www/dist就是打包后的vue项目根目录
live-server        # 安装了live-server，终端下就会提供一个全局的命令。用于把当前目录作为web根目录，启动http服务。默认端口是8080.
```

